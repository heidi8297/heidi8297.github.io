<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">
  <title>Natural Disasters</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-12NPY4109R');
  </script> -->


  <!-- Make the webpage perform better on mobile? -->
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=0.24,maximum-scale=5.0,user-scalable=yes">

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="description" content="A look at the increasing natural disasters across the globe between 1960 and 2018">
  <meta name="news_keywords" content="disasters, scrollytelling, scroll-driven, graphics, d3, scrollmagic, waypoints, graph-scoll, scrollstory, in-view">

  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Natural Disasters" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://heidistockton.com/naturaldisasters/naturalDisastersThumbnail.png" />
  <meta property="og:description" content="A look at the increasing natural disasters across the globe between 1960 and 2018" />
  <meta property="og:url" content="http://heidistockton.com/naturaldisasters/" />

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Cabin+Sketch&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <script defer src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>

  <!-- primary style sheet -->
  <link rel="stylesheet" href="/core.css" type="text/css">
  <link rel='stylesheet' href='disaster-styles.css' />


</head>


<body>

  <header>
    <h1>Natural Disasters</h1>
    <h2>1960-2018</h2>
    <p>This is my paragraph text to test font styles and other formatting.</p>
  </header>


  <main>
    <div class='library__graphic graphic flex-container'>
      <!-- scrolly text section -->
      <div class='graphic__prose'>
        <p class='spacer'>If the visualisation doesn't fit your screen, try zooming out with ctrl + - / Cmd + -.</p>
        <p class='trigger active' data-step='0'>pane ONE: Step 1 in the graphic. It triggers in the middle of the viewport. For this graphic, it is the same as the initial state so the reader doesn&rsquo;t miss anything.</p>
        <p class='trigger' data-step='1'>pane TWO: Step 2A arrives. The graphic should be locking into a fixed position right about now. We could have a whole bunch of these &ldquo;fixed&rdquo; steps.</p>
        <p class='trigger' data-step='2'>pane THREE: Step 2B arrives. The graphic should be locking into a fixed position right about now. We could have a whole bunch of these &ldquo;fixed&rdquo; steps.</p>
        <p class='trigger' data-step='3'>pane THREE B: Step 3 is neato.</p>
        <p class='trigger' data-step='4'>pane FOUR: Step 4 concludes our brief tour. The graphic should now go back to its original in-flow position, elegantly snapping back into place.</p>
        <p class='trigger' data-step='5'>pane FIVE: This is the final landing step.</p>
        <p class='trigger' data-step='6'>pane SIX: This is another final landing step.</p>
        <p class='trigger' data-step='7'>pane SEVEN: This is yet another final landing step.</p>
        <p class='trigger' data-step='8'>pane EIGHT: This is the final landing step.</p>
        <p class='trigger' data-step='9'>pane NINE: This is another final landing step.</p>
        <p class='trigger' data-step='10'>pane NINE B: This is yet another final landing step.</p>
        <p class='trigger' data-step='11'>pane TEN: This is yet another final landing step.</p>
        <p class='thanks'>Thank you!</p>
      </div>

      <!-- this is where the drawing spaces will sit (canvas and svg) -->
      <div id="viz-container"></div>
    </div>







    <div id="contactMe">
      <!-- placeholder for my standard "contact me" footer content -->
      <div w3-include-html="/footer.html"></div>
    </div>

  </main>




  <!-- for the graphic -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src='disaster-main.js'></script>

  <!-- load core.js file -->
  <script src="/core.js"></script>

  <!-- The scroll library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/noframework.waypoints.js"></script>

  <!-- setting up the waypoints/triggers -->
  <script>
    (function() {

      // helper function so we can map over dom selection
      function selectionToArray(selection) {
        var len = selection.length
        var result = []
        for (var i = 0; i < len; i++) {
          result.push(selection[i])
        }
        return result
      } // selectionToArray()

      function waypoints() {
        // select elements
        var graphicEl = document.querySelector('.graphic')
        var triggerEls = selectionToArray(graphicEl.querySelectorAll('.trigger'))

        // a global function creates and handles all the vis + updates
        var graphic = createGraphic('.graphic')

        // setup a waypoint trigger for each trigger element
        var waypoints = triggerEls.map(function(el) {

          // get the step, cast as number
          var step = +el.getAttribute('data-step')

          return new Waypoint({
            element: el, // our trigger element
            handler: function(direction) {
              // if the direction is down then we use that number,
              // else, we want to trigger the previous one
              var nextStep = direction === 'down' ? step : Math.max(0, step - 1)

              // tell our graphic to update with a specific step
              graphic.update(nextStep)

              if (direction === 'down') {
                triggerEls[Math.max(0, step - 1)].classList.remove("active")
                triggerEls[step].classList.add("active")
              } else {
                triggerEls[step].classList.remove("active")
                triggerEls[nextStep].classList.add("active")
              }

            },
            offset: '65%',  // trigger 65% down from top of the viewport
          }) // return new Waypoint
        }) // var waypoints

      } // waypoints()

      waypoints()

    })()
  </script>

  <!-- run javascript to include external html files where specified -->
  <script>includeHTML()</script>

</body>

</html>
